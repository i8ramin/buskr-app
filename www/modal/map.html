<!DOCTYPE html>
<html>
<head>
  <meta charset="utf8">
  <title>Map</title>

  <link rel="stylesheet" href="/components/reset-css/reset.css" />
  <!-- <link rel="stylesheet" href="/vendor/topcoat/css/topcoat-buskr.css" /> -->
  <link rel="stylesheet" href="/stylesheets/application.css" />
  <link rel="stylesheet" href="/stylesheets/theme.css" />
  <link rel="stylesheet" href="/stylesheets/map.css" />

  <script src="/javascripts/onerror.js"></script>
  <script src="/javascripts/console.log.js"></script>

  <script src="/cordova.js"></script>
  <script src="/components/steroids-js/steroids.js"></script>

  <script src="/components/jquery/jquery.js"></script>
  <script src="/components/fastclick/lib/fastclick.js"></script>

  <script src="/components/angular/angular.js"></script>
  <script src="/components/angular-touch/angular-touch.js"></script>

  <script src="/components/lodash/dist/lodash.js"></script>

  <script src="/models/models.js"></script>
</head>
<body id="artistMap">
  <div id="map">
  </div>
  <button class="close-map" onclick="steroids.modal.hide();">Close</button>

<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDWk9NAbOB5ZyZscBW7R2uzozNFNPgulgQ&sensor=true"></script>
<script type="text/javascript">
  // FastClick.attach(document.body);

  (function () {
    var MY_MAPTYPE_ID = 'custom_style';
    var map;
    var mapLatlng;
    var mapMarker;
    var featureOptions;
    var styledMapOptions;
    var customMapType;
    var mapOptions;
    var mapWrapperElem = document.getElementById('map');
    var position = JSON.parse(localStorage.getItem('position'));

    google.maps.visualRefresh = true;

    mapLatlng = new google.maps.LatLng(position.latitude, position.longitude);

    featureOptions = [
      {
        "stylers": [
          { "saturation": -100 }
        ]
      },{
        "featureType": "water",
        "stylers": [
          { "visibility": "on" },
          { "color": "#808080" }
        ]
      },{
        "featureType": "transit",
        "stylers": [
          { "visibility": "off" }
        ]
      },{
        "featureType": "landscape",
        "stylers": [
          { "visibility": "simplified" }
        ]
      }
    ];

    function initializeMap() {
      mapOptions = {
        center: mapLatlng,
        zoom: 14,
        disableDefaultUI: true,
        zoomControl: true,
        mapTypeId: MY_MAPTYPE_ID
      };

      map = new google.maps.Map(mapWrapperElem, mapOptions);

      styledMapOptions = {
        name: 'Custom Style'
      };

      customMapType = new google.maps.StyledMapType(featureOptions, styledMapOptions);
      map.mapTypes.set(MY_MAPTYPE_ID, customMapType);

      mapMarker = new google.maps.Marker({
        position: mapLatlng,
        animation: google.maps.Animation.DROP,
        map: map,
        title: '#{@profile.location.description}'
      });
    };

    google.maps.event.addDomListener(window, 'load', initializeMap);

  })();
</script>

</body>
</html>
